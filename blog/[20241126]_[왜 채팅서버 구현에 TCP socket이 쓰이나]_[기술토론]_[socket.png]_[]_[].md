# Socket이란
네트워크 상에서 유저와 유저를 양방향으로 실시간으로 통신을 할수 있는 인터페이스 입니다

## 채팅에서 Socket을 사용한 이유
1. 양방향으로 실시간 통신을 할 수 있습니다 채팅은 기본적으로 실시간으로 진행을 해야 되며 서버에서 클라이언트로 바로 푸쉬를 할수 있어야 합니다 만약에 http 처럼 클라이언트가 계속 서버한테 요청을 하고 메세지를 받는 방법은 비효율적입니다
   
2. 효율적인 네트워크와 클라이언트 관리 입니다 소켓은 한번 연결된 통신은 물리적으로 끊지 않는다면 끊어지지 않고 클라이언트가 여러명이 들어와도 소켓은 끊어지진 않습니다

### 소켓에서 클라이언트 관리 방법
클라이언트 관리는 MAP을 이용해서 키값은 채팅리스트 번호값을 넣고 벨류에는 연결한 소켓 객체의 값을 이용해서 관리를 했습니다 그래서 각 클라이언트로 연결하기 위해 스레드를 사용해서 실시간 통신을 할수 있게 합니다

### 클라이언트가 여러명이 채팅을 할떄는 어떻게 하는가?
스레드풀을 이용해서 동시에 유저들이 메세지를 나눌수있게 합니다

#### 스레드풀이란
스레드를 미리 준비하고 요청이 들어왔을때 미리 생성된 스레드로 작업을 하는것입니다



### 소켓이외에 다른 방법
1.HTTP Lollpolling 방법은 다른 유저에게 메세지가 왔는지 계속 서버에게 요청을 하는 방식입니다 이렇게 되면 상대방이 메세지를 보내지 않았는데 계속 요청을 하게 되면 네트워크적으로 비효율적입니다 그리고 만약 서버 부하가 생기면 데이터 받는 타이밍이 달라질수도 있습니다
  
2.gRPC는 1:1 채팅만을 구현한다고 했을때는 무겁다는 생각이 들었습니다 구글이 Protocol Buffers는 데이터 직렬화 방식인데 간단히 말하면 데이터 구조를 Proto 파일에서 데이터를 표현할 구조를 정의를 합니다 직렬화는 원시 데이터인 객체나 메세지값을 이진 형식으로 변환을 하는 바이너리 데이터 변환하는 과정을 해야 되는것입니다 그에 비해 소켓은 어떠한 프로토콜에 종속 받지 않고 데이터값도 따로 정의할 필요 없다는 점에서 소켓을 사용을 했습니다
---  


## 네트워크 프로토콜, TCP vs UDP
### TCP란? 
tcp는 연결기반 프로토콜입니다 그래서 안전성이 높습니다 연결기반이라 함은 수신자와 발신자를 먼저 연결 설정을 유지를 하고 데이터가 목적지에 잘 도착했는지 확인을 하고 수신을 해줍니다

### UDP란? 
udp는 tcp에 비해 비연결성 기반으로 되었고 연결 절차가 있는 없습니다 그래서 데이터를 주고 받을때 발신자가 일방적으로 발산하는 방식이며 이는 스트리밍 서비스나 게임같은 빠른속도를 중요시하는 상황에서 자주 사용합니다 


### TCP와 UDP의 차이점은 무엇인가요?
1.속도의 차이가 있습니다 tcp는 연결을 확인하고 데이터가 잘 도착했는지 확인하는 작업이 있는것에 비해 udp는 그런 일련의 과정이 없으니 데이터를 빠르게 전송할수 있습니다
2.전송순서 tcp는 데이터 순서를 보장하고 udp는 데이터 순서를 보장해주지 않습니다
3.수신여부 확인 udp는 수신여부를 확인하지 않고 tcp는 수신여부를 확인합니다
---


## 소켓을 이용한 아키텍처  
1. 클라이언트에서 socket ip와 port 번호를 지정해줍니다
2. 서버 port와 클라이언트 port를 연결이 되면 스레드로 클라이언트를 관리를 합니다
3. 다른 유저에게 데이터를 송수신 하기 위해서 핸들러를 이용합니다
4. 유저의 방 관리는 리스트를 이용해서 방을 관리 할수 있게 해줍니다

### 이미지 송수신 방법
A는 이미지를 보냈을때 서버는 이미지 바이트 배열로 변환 합니다 그래서 이미지의 크기 데이터를 전송하고 b는 서버에서 받은 이미지의 크기를 읽은 다음 바이트 배열로 만들어서 데이터를 수신하고 저장한 다음 이미지를 유저에게 보여주게 됩니다
